{{ if .Values.vault.enabled }}
apiVersion: secrets-manager.tuenti.io/v1alpha1
kind: SecretDefinition
metadata:
  name: {{ .Values.name }}-swagger-client
  labels:
    {{- include "calhoun.labels" . | nindent 4 }}
spec:
  name: {{ .Values.name }}-swagger-client
  keysMap:
    id:
      path: {{ .Values.vault.pathPrefix }}/calhoun/swagger-client
      key: id
    realm:
      path: {{ .Values.vault.pathPrefix }}/calhoun/swagger-client
      key: realm
---
apiVersion: secrets-manager.tuenti.io/v1alpha1
kind: SecretDefinition
metadata:
  name: {{ .Values.name }}-app-sa
  labels:
    {{- include "calhoun.labels" . | nindent 4 }}
spec:
  name: {{ .Values.name }}-app-sa
  keysMap:
    service-account.json:
      path: {{ .Values.vault.pathPrefix }}/calhoun/app-sa
      encoding: base64
      key: key
{{- if .Values.proxy.tcell.enabled }}
---
apiVersion: secrets-manager.tuenti.io/v1alpha1
kind: SecretDefinition
metadata:
  name: {{ .Values.name }}-proxy-tcell-secrets
  labels:
    {{- include "calhoun.labels" . | nindent 4 }}
spec:
  name: {{ .Values.name }}-proxy-tcell-secrets
  keysMap:
    app-id:
      path: {{ .Values.proxy.tcell.vaultPrefix }}/tcell_app_id
      key: tcell_app_id
    api-key:
      path: {{ .Values.proxy.tcell.vaultPrefix }}/tcell_api_key
      key: tcell_api_key
{{- end }}
{{ end }}
