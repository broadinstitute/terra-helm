apiVersion: secrets-manager.tuenti.io/v1alpha1
kind: SecretDefinition
metadata:
  name: {{ index .Values "actions-runner-controller" "nameOverride" }}-controller-secretdef
  labels: 
    {{- include "dsp-gha-runner-controller.labels" . | nindent 4 }}
spec:
  name: {{ index .Values "actions-runner-controller" "authSecret" "name" }}
  keysMap:
    {{- if .Values.vault.github.appSecret.path }}
    github_app_id:
      path: {{ .Values.vault.github.appSecret.path }}
      key: {{ .Values.vault.github.appSecret.appIdField }}
      encoding: {{ .Values.vault.github.appSecret.encoding }}
    github_app_installation_id:
      path: {{ .Values.vault.github.appSecret.path }}
      key: {{ .Values.vault.github.appSecret.appInstallationIdField }}
      encoding: {{ .Values.vault.github.appSecret.encoding }}
    github_app_private_key:
      path: {{ .Values.vault.github.appSecret.path }}
      key: {{ .Values.vault.github.appSecret.appPrivateKeyField }}
      encoding: {{ .Values.vault.github.appSecret.encoding }}
    {{- end }}
    {{- if .Values.vault.github.tokenSecret.path }}
    github_token:
      path: {{ .Values.vault.github.tokenSecret.path }}
      key: {{ .Values.vault.github.tokenSecret.tokenField }}
      encoding: {{ .Values.vault.github.tokenSecret.encoding }}
    {{- end }}
