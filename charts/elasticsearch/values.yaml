# Set default values on chart from elastic.co
name: elasticsearch

ingress:
  # ingress.enabled -- Whether to create Ingress, Service and associated config resources
  enabled: true
  # ingress.staticIpName -- (string) Required. Name of the static IP, allocated in GCP, to associate with the Ingress
  staticIpName: null
  # ingress.sslPolicy -- (string) Name of a GCP SSL policy to associate with the Ingress
  sslPolicy: null
  # ingressTimeout -- (number) number of seconds requests on the https loadbalancer will time out after
  timeoutSec: 120
  cert:
    # ingress.cert.preSharedCerts -- Array of pre-shared GCP SSL certificate names to associate with the Ingress
    preSharedCerts: []

elasticsearch:

  image: "docker.io/broadinstitute/elasticsearch"
  imageTag: 5.4.0_6

  podSecurityPolicy:
    create: true

  rbac:
    create: true
  
  service:
    type: LoadBalancer
    loadBalancerIP: null
    annotations: 
      # Associate a backend config with the ingress: https://cloud.google.com/kubernetes-engine/docs/how-to/ingress-features#associating_backendconfig_with_your_ingress
      cloud.google.com/backend-config: '{"default": "elasticsearch-ingress-backendconfig"}'
      # Enable container-native load balancing https://cloud.google.com/kubernetes-engine/docs/how-to/container-native-load-balancing
      cloud.google.com/neg: '{"ingress": true}'
  # same as GCE VMS
  esJavaOpts: "-Xms3500m -Xmx3500m"

  #set resources to be same as GCEs
  resources:
    requests:
      cpu: 2
      memory: 8Gi
    limits:
      cpu: 2
      memory: 8Gi

  esConfig:
    elasticsearch.yml: |
      http:
        cors:
          enabled: true
          allow-origin: '*'
      xpack:
        graph:
          enabled: false
        ml:
          enabled: false
        monitoring:
          enabled: false
        security:
          enabled: false
        watcher:
          enabled: false
    