apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: {{ .Values.global.name }}-service-role
  annotations:
    # Used by liquibase-migration during wave -1
    argocd.argoproj.io/sync-wave: "-1"
  labels:
{{ include "workspacemanager.labels" . | indent 4 }}
rules:
- apiGroups: ['policy']
  resources: ['podsecuritypolicies']
  verbs:     ['use']
  resourceNames:
  - terra-default-psp
- apiGroups: ['']
  resources: ['secrets']
  verbs: ['get', 'create']
- apiGroups: [""]
  resources: ["pods"]
  verbs: ["get", "list", "watch"]
- apiGroups: ["extensions", "apps"]
  resources: ["deployments"]
  verbs: ["get", "list", "watch"]
