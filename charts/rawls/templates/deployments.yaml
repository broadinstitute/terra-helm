apiVersion: apps/v1
kind: Deployment
metadata:
  name: rawls-deployment
  labels:
{{ include "rawls.labels" . | indent 4 }}
spec:
  replicas: 1
  revisionHistoryLimit: 0
  strategy:
    type: RollingUpdate
    rollingUpdate:
      maxSurge: 0
      maxUnavailable: 1
  selector:
    matchLabels:
      deployment: rawls-backend 
  template: 
    metadata:
      labels:
        deployment: rawls-backend
{{ include "rawls.labels" . | indent 8 }}
    spec: 
      serviceAccountName: rawls-sa
      hostAliases:
      - ip: 127.0.0.1 
        hostnames:
        - app
        - sqlproxy
      containers:
      - name: rawls-backend-app
        image: gcr.io/broad-dsp-gcr-public/rawls:e52fb5133eab
        ports: 
          - name: metrics
            containerPort: 9090
            protocol: TCP
            
